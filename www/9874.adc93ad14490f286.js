"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9874],{9874:(D,S,o)=>{o.r(S),o.d(S,{SongsSearchPageModule:()=>R});var g=o(6814),f=o(95),c=o(5548),p=o(4248),x=o(8645),I=o(7394);class A extends I.w0{constructor(n,s){super()}schedule(n,s=0){return this}}const d={setInterval(r,n,...s){const{delegate:t}=d;return null!=t&&t.setInterval?t.setInterval(r,n,...s):setInterval(r,n,...s)},clearInterval(r){const{delegate:n}=d;return((null==n?void 0:n.clearInterval)||clearInterval)(r)},delegate:void 0};var P=o(9039);const m={now:()=>(m.delegate||Date).now(),delegate:void 0};class h{constructor(n,s=h.now){this.schedulerActionCtor=n,this.now=s}schedule(n,s=0,t){return new this.schedulerActionCtor(this,n).schedule(t,s)}}h.now=m.now;const b=new class Z extends h{constructor(n,s=h.now){super(n,s),this.actions=[],this._active=!1}flush(n){const{actions:s}=this;if(this._active)return void s.push(n);let t;this._active=!0;do{if(t=n.execute(n.state,n.delay))break}while(n=s.shift());if(this._active=!1,t){for(;n=s.shift();)n.unsubscribe();throw t}}}(class T extends A{constructor(n,s){super(n,s),this.scheduler=n,this.work=s,this.pending=!1}schedule(n,s=0){var t;if(this.closed)return this;this.state=n;const i=this.id,a=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(a,i,s)),this.pending=!0,this.delay=s,this.id=null!==(t=this.id)&&void 0!==t?t:this.requestAsyncId(a,this.id,s),this}requestAsyncId(n,s,t=0){return d.setInterval(n.flush.bind(n,this),t)}recycleAsyncId(n,s,t=0){if(null!=t&&this.delay===t&&!1===this.pending)return s;null!=s&&d.clearInterval(s)}execute(n,s){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const t=this._execute(n,s);if(t)return t;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,s){let i,t=!1;try{this.work(n)}catch(a){t=!0,i=a||new Error("Scheduled action threw falsy error")}if(t)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:n,scheduler:s}=this,{actions:t}=s;this.work=this.state=this.scheduler=null,this.pending=!1,(0,P.P)(t,this),null!=n&&(this.id=this.recycleAsyncId(s,n,null)),this.delay=null,super.unsubscribe()}}});var w=o(9360),U=o(8251),M=o(3997),e=o(6689),J=o(4423),_=o(8027);const q=["searchbar"];function Q(r,n){1&r&&(e.TgZ(0,"div",9),e._UZ(1,"ion-spinner",10),e.qZA())}function F(r,n){if(1&r&&(e.TgZ(0,"p",13),e._uU(1),e.qZA()),2&r){const s=e.oxw(2);e.xp6(1),e.hij("Sua busca retornou ",s.songs.length," resultado(s)")}}const O=function(r){return["/musicas",r]};function Y(r,n){if(1&r&&(e.TgZ(0,"ion-card")(1,"ion-item",14)(2,"div",15),e._uU(3),e.qZA(),e.TgZ(4,"ion-label")(5,"h4"),e._uU(6),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.qZA()()()()),2&r){const s=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(4,O,s.number)),e.xp6(2),e.Oqu(s.number),e.xp6(3),e.Oqu(s.title),e.xp6(2),e.Oqu(s.resume)}}function E(r,n){if(1&r&&(e.TgZ(0,"ion-list"),e.YNc(1,F,2,1,"p",11),e.YNc(2,Y,9,6,"ion-card",12),e.qZA()),2&r){const s=e.oxw();e.xp6(1),e.Q6J("ngIf",s.searched&&!s.searching&&s.songs.length),e.xp6(1),e.Q6J("ngForOf",s.songs)}}function N(r,n){1&r&&(e.TgZ(0,"div",16),e._uU(1," Para procurar uma m\xfasica espec\xedfica, digite um trecho da letra."),e._UZ(2,"br"),e._uU(3," \xc9 necess\xe1rio digitar no m\xednimo 3 palavras. "),e.qZA())}function j(r,n){1&r&&(e.TgZ(0,"div",17)(1,"h4"),e._uU(2,"Nenhum resultado encontrado"),e.qZA(),e._UZ(3,"img",18),e.TgZ(4,"p"),e._uU(5,"Tente refazer a busca com outras palavras. Talvez a m\xfasica ainda n\xe3o tenha sido cadastrada no sistema."),e.qZA()())}const z=[{path:"",component:(()=>{var r;class n{constructor(t,i){this.songService=t,this.errorService=i,this.queryUpdate=new x.x,this.songs=[],this.searched=!1,this.searching=!1,this.queryUpdate.pipe(function C(r,n=b){return(0,w.e)((s,t)=>{let i=null,a=null,l=null;const v=()=>{if(i){i.unsubscribe(),i=null;const u=a;a=null,t.next(u)}};function V(){const u=l+r,y=n.now();if(y<u)return i=this.schedule(void 0,u-y),void t.add(i);v()}s.subscribe((0,U.x)(t,u=>{a=u,l=n.now(),i||(i=n.schedule(V,r),t.add(i))},()=>{v(),t.complete()},void 0,()=>{a=i=null}))})}(600),(0,M.x)()).subscribe(()=>this.doSearch())}ionViewDidEnter(){this.searchbar.setFocus()}ngOnInit(){}doSearch(){const t=this.query,i={query:t};this.countWords(t)<3||(this.searching=!0,this.songService.search(i).subscribe(a=>{this.songs=a,this.searching=!1,this.searched=!0},a=>{this.searching=!1,this.errorService.handleError(a)}))}clearSearch(){this.songs=[],this.searched=!1}countWords(t){return t.replace(/(\r\n|\n|\r)/g," ").trim(),t.split(/\s+/g).length}}return(r=n).\u0275fac=function(t){return new(t||r)(e.Y36(J.o),e.Y36(_.T))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-songs-search"]],viewQuery:function(t,i){if(1&t&&e.Gf(q,5),2&t){let a;e.iGM(a=e.CRH())&&(i.searchbar=a.first)}},decls:12,vars:5,consts:[[1,"ion-no-border"],["slot","start"],["defaultHref","/musicas"],["mode","ios","placeholder","Buscar m\xfasica",3,"ngModel","ngModelChange","ionClear"],["searchbar",""],["class","loading",4,"ngIf"],[4,"ngIf"],["class","loading text-center ion-padding",4,"ngIf"],["class","empty",4,"ngIf"],[1,"loading"],["name","dots"],["class","px-4 text-sm",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"px-4","text-sm"],["lines","none",3,"routerLink"],[1,"w-10","text-md","font-semibold"],[1,"loading","text-center","ion-padding"],[1,"empty"],["src","./assets/images/empty_search.png","width","200","alt",""]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA()(),e.TgZ(4,"ion-toolbar")(5,"ion-searchbar",3,4),e.NdJ("ngModelChange",function(l){return i.query=l})("ngModelChange",function(l){return i.queryUpdate.next(l)})("ionClear",function(){return i.clearSearch()}),e.qZA()()(),e.TgZ(7,"ion-content"),e.YNc(8,Q,2,0,"div",5),e.YNc(9,E,3,2,"ion-list",6),e.YNc(10,N,4,0,"div",7),e.YNc(11,j,6,0,"div",8),e.qZA()),2&t&&(e.xp6(5),e.Q6J("ngModel",i.query),e.xp6(3),e.Q6J("ngIf",i.searching),e.xp6(1),e.Q6J("ngIf",i.searched&&i.songs),e.xp6(1),e.Q6J("ngIf",!i.searched),e.xp6(1),e.Q6J("ngIf",i.searched&&!i.searching&&0==i.songs.length))},dependencies:[g.sg,g.O5,f.JJ,f.On,c.oU,c.Sm,c.PM,c.W2,c.Gu,c.Ie,c.Q$,c.q_,c.VI,c.PQ,c.sr,c.j9,c.cs,c.YI,p.rH]}),n})()}];let B=(()=>{class r{}return r.\u0275fac=function(s){return new(s||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[p.Bz.forChild(z),p.Bz]}),r})(),R=(()=>{class r{}return r.\u0275fac=function(s){return new(s||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[g.ez,f.u5,c.Pc,B]}),r})()}}]);